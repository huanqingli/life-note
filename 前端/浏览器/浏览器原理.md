## 浏览器原理
#### 浏览器结构
1. 用户界面 - 包括地址栏、前进/后退按钮、书签菜单等。
2. 浏览器引擎 - 在用户界面和呈现引擎之间传送指令。
- 数据存储。这是持久层。浏览器需要在硬盘上保存各种数据，例如 Cookie。新的 HTML 规范 (HTML5) 定义了“网络数据库”，这是一个完整（但是轻便）的浏览器内数据库。
3. 呈现引擎 - 负责显示请求的内容。如果请求的内容是 HTML，它就负责解析 HTML 和 CSS 内容，并将解析后的内容显示在屏幕上。Firefox 使用的是 Gecko，而 Safari 和 Chrome 浏览器使用的都是 WebKit
4. 
- 网络 - 用于网络调用，比如 HTTP 请求。
- 用户界面后端 - 用于绘制基本的窗口小部件，比如组合框和窗口。其公开了与平台无关的通用接口，而在底层使用操作系统的用户界面方法。
- JavaScript 解释器。用于解析和执行 JavaScript 代码。  
和大多数浏览器不同，Chrome 浏览器的每个标签页都分别对应一个呈现引擎实例。每个标签页都是一个独立的进程。  

#### 主流程
1. 呈现引擎通过网络层请求文件。
2. 解析 html 文档生成 DOM TREE，同时解析 css文件和标签，生成 **呈现树**(render TREE)。
3. render TREE 构建完毕后，开始**布局**，也就是分配每个节点的具体坐标。
4. 之后引擎遍历呈现树通过用户界面后端层**绘制**(painting)。  

需要着重指出的是，这是一个渐进的过程。为达到更好的用户体验，呈现引擎会力求尽快将内容显示在屏幕上。它不必等到整个 HTML 文档解析完毕之后，就会开始构建呈现树和设置布局。在不断接收和处理来自网络的其余内容的同时，呈现引擎会将部分内容解析并显示出来。  

css 或者 dom 发生变化会引发重绘或重排。颜色变化会重绘，dom增删改尺寸变化则会重排。重排可能引发性能问题。 
[重绘重排](https://juejin.im/post/5d89798d6fb9a06b102769b1#heading-7)

[参考](https://www.html5rocks.com/zh/tutorials/internals/howbrowserswork/)

