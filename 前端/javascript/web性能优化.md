### web 性能优化
#### 为什么要优化
1. 优化性能很重要，速度慢体验很差。加载速度慢是用户最讨厌的事情之一，给用户造成的压力如同看恐怖电影。
2. 直接影响你的产品，如用户留存，订单数等。2006年Google把每次查询降速 0.5秒，导致用户减少了 25%的请求。类似的例子还有嗯多。
3. 性能好可以分成两部分，加载速度快，加载后工作流畅。
4. 加载速度又分为，服务器返回静态文件快，拿到文件后在浏览器渲染快。
#### js可优化的点
1. 缩小体积。(打包工具会做这一步，写代码还是要以可读性高为重)工具压缩一般能减少 30% 的体积。
2. 脚本标签会阻碍浏览器解析 HTML 文件，当遇到脚本文件时，浏览器会先执行脚本之后再继续解析。所以脚本标签可以增加 async 或者 defer 属性，async 就是下载脚本和解析一起进行，下载完了运行脚本之后继续解析。defer 是下载和解析同步进行，等解析完了再运行脚本。此方式可以节约200-500ms不等。(现在HTML都脚本生成的了，这些就没什么影响了)
3. 拆包，打一个大包通常包含了很多用户根本用不到的东西。目前常用的比如动态加载，例如vue根据页面动态import，用户在使用相应页面是才会加载相应脚本。如果只优化一点就优化这一点吧，提升很大。类似 webpack-libs-optimizations 的插件会优化一些常用又很大还有很多项目用不到的代码的包。
#### css优化的点
1. 压缩。也是交给构建工具的。
2. 即时加载css和非即时加载css。布局等必须的css直接放在html文件里，而弹出层交互需要的css可以作为样式表，避免渲染出没有样式的页面影响体验和效率。
#### HTTP的优化点
1. 压缩html。
2. gzip，通过nginx等设置。Brotli 可代替gzip，效果还要好 20%-30%。
3. CDN，全世界大量用户使用你的服务时，CDN很有效。
4. 预加载。google 会为用户预加载搜索到的第一个结果。link 标签的 rel 属性有五种预加载方式。
5. 减少http请求个数。
6. 减少 cookie 的大小，使用无 cookie 的域。
#### 图片
1. 压缩方式和图片类型。

[参考](https://3perf.com/talks/web-perf-101/)


